<div class="container-base p-4">
  <div class="card">
    <!-- Loading State -->
    @if (loading) {
        <div class="flex justify-center items-center min-h-screen">
            <div class="text-center">
                <i class="pi pi-spin pi-spinner text-4xl text-blue-500 mb-4"></i>
                <p class="text-gray-600">Loading tournament...</p>
            </div>
        </div>
    }

    <!-- Error State -->
    @if (errorMessage && !loading) {
        <div class="flex justify-center items-center min-h-screen">
            <div class="text-center">
                <i class="pi pi-exclamation-triangle text-4xl text-red-500 mb-4"></i>
                <p class="text-red-600 mb-4">{{ errorMessage }}</p>
                <button pButton type="button" label="Go Back" icon="pi pi-arrow-left" class="p-button-outlined"
                    (click)="goBack()">
                </button>
            </div>
        </div>
    }

    <!-- Main Content -->
    @if (!loading && !errorMessage && tournament) {
        <!-- Page Header -->
        <div class="font-semibold text-xl mb-1">Tournament: {{ tournament.name }}</div>
        <p class="text-gray-600 mb-4">Manage tournament details, participants, and matches</p>
        <div class="flex justify-end mb-4">
            <button pButton type="button" label="Back" icon="pi pi-arrow-left" class="p-button-outlined"
                (click)="goBack()">
            </button>
        </div>

        <div class="space-y-6">

        <!-- Tournament Tabs -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow">
            <p-tabs value="0">
                <p-tablist>
                    <p-tab value="0">Details</p-tab>
                    <p-tab value="1">Players</p-tab>
                    <p-tab value="2">Groups</p-tab>
                    <p-tab value="3">Matches</p-tab>
                    <p-tab value="4">Standings</p-tab>
                    <p-tab value="5">Knockout</p-tab>
                </p-tablist>
                <p-tabpanels>
                    <!-- Tournament Details Tab -->
                    <p-tabpanel value="0">
                        <app-tournament-details [tournament]="tournament" [tournamentConfig]="tournamentConfig"
                            [roundRobinConfig]="roundRobinConfig" [venues]="venues"
                            (saveTournament)="onTournamentSaved($event)" (cancelEdit)="onTournamentCancelled()"
                            (resetForm)="onTournamentReset()">
                        </app-tournament-details>
                    </p-tabpanel>
                    <!-- Participants Management Tab -->
                    <p-tabpanel value="1">
                        <app-tournament-participants [tournament]="tournament" [participants]="participants"
                            (participantsChanged)="loadParticipants()">
                        </app-tournament-participants>
                    </p-tabpanel>
                    <!-- Groups Management Tab -->
                    <p-tabpanel value="2" disabled="!tournament">
                        @if (tournament) {
                            <app-tournament-groups [tournament]="tournament" [venues]="venues"
                                [participants]="participants" (groupsUpdated)="onGroupsUpdated()"
                                (teamsUpdated)="onTeamsUpdated()">
                            </app-tournament-groups>
                        }
                    </p-tabpanel>
                    <!-- Matches Management Tab -->
                    <p-tabpanel value="3" disabled="!tournament">
                        @if (tournament) {
                            <app-tournament-matches [tournament]="tournament" [groups]="groups"
                                [teams]="teams" [matches]="matches" [venues]="venues" (matchesUpdated)="onMatchesUpdated()">
                            </app-tournament-matches>
                        }
                    </p-tabpanel>
                    <!-- Bracket Tab -->
                    <p-tabpanel value="5" disabled="!tournament">
                        @if (tournament) {
                            <app-knockout-bracket 
                                [tournament]="tournament" 
                                [teams]="teams"
                                [venues]="venues"
                                [matches]="matches"
                                (matchesUpdated)="onMatchesUpdated()">
                            </app-knockout-bracket>
                        }
                    </p-tabpanel>
                    <!-- Standings Tab -->
                    <p-tabpanel value="4" disabled="!tournament">
                        @if (tournament) {
                            <app-tournament-standings [tournament]="tournament" [groups]="groups"
                                [teams]="teams" [matches]="matches" (standingsUpdated)="onStandingsUpdated()">
                            </app-tournament-standings>
                        }
                    </p-tabpanel>
                </p-tabpanels>
            </p-tabs>
        </div>
        </div>
    }

    <!-- Toast Messages -->
    <p-toast></p-toast>

    <!-- Confirmation Dialog -->
    <p-confirmDialog></p-confirmDialog>
  </div>
</div>